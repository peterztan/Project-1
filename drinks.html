<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Project 1</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/style.css">
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand" href="#">Drinks</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="why-peta.html">Why PETA?</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="about-us.html">About Our Team</a>
                </li>

            </ul>
        </div>
    </nav>

    <nav class="navbar navbar-light bg-light">
        <a class="navbar-brand" href="#">DRINKS</a>
    </nav>

    <div id="map"></div>
    <div id="right-panel">
        <h2>Results</h2>
        <ul id="places"></ul>
        <button id="more">More results</button>
    </div>

    <script>
        // This example requires the Places library. Include the libraries=places
        // parameter when you first load the API. For example:
        // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">

        var map;
        var markers = [
            {
                coords: { lat: 39.0900, lng: -94.5851 },
                iconImage: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png',
                content: 'Up Down KC '
            },
            {
                coords: { lat: 39.089711, lng: -94.584027 },
                content: 'Manifesto'
            },
            {
                coords: { lat: 39.102558, lng: -94.599090 },
                content: 'The Ship'
            },
            {
                coords: { lat: 39.097353, lng: -94.583184 },
                content: ' Power and Light District '
            },
            {
                coords: { lat: 39.093531, lng: -94.583383 },
                content: ' Toms Town distillery '
            },
            {
                coords: { lat: 39.099701, lng: -94.579931 },
                content: ' ZooBar '
            },


        ];



        function initMap() {
            // Create the map.
            var kansasCity = new google.maps.LatLng(39.10345, -94.58311);
            map = new google.maps.Map(document.getElementById('map'), {
                center: kansasCity,
                zoom: 14,
            });

            // Create the places service.
            var service = new google.maps.places.PlacesService(map);
            var getNextPage = null;
            var moreButton = document.getElementById('more');
            moreButton.onclick = function () {
                moreButton.disabled = true;
                if (getNextPage) getNextPage();
            };

            // Perform a nearby search.
            service.nearbySearch(
                { location: kansasCity, radius: 500, type: ['store'] },
                function (results, status, pagination) {
                    if (status !== 'OK') return;

                    //makes the weird image markers
                    createMarkers(results);
                    moreButton.disabled = !pagination.hasNextPage;
                    getNextPage = pagination.hasNextPage && function () {
                        pagination.nextPage();
                    };
                });
        }

        function createMarkers(places) {
            var bounds = new google.maps.LatLngBounds();
            // var placesList = document.getElementById('places');

            for (var i = 0, place; place = places[i]; i++) {
                // console.log(place.types);s

                if (!place.types.includes('store')) { continue }

                var image = {
                    url: place.icon,
                    size: new google.maps.Size(71, 71),
                    origin: new google.maps.Point(0, 0),
                    anchor: new google.maps.Point(17, 34),
                    scaledSize: new google.maps.Size(25, 25)
                };

                var marker = new google.maps.Marker({
                    map: map,
                    icon: image,
                    title: place.name,
                    position: place.geometry.location
                });

                // var li = document.createElement('li');
                // li.textContent = place.name;
                // li.classList.add('place-item')
                // li.setAttribute('data-lat', place.geometry.location.lat())
                // li.setAttribute('data-lng', place.geometry.location.lng())

                // placesList.appendChild(li);

                bounds.extend(place.geometry.location);
            }
            map.fitBounds(bounds);


            // attachSecretMessage(marker, secretMessages[i]);

            function attachSecretMessage(marker, secretMessage) {
                var infowindow = new google.maps.InfoWindow({
                    content: secretMessage
                });

                marker.addListener('click', function () {
                    infowindow.open(marker.get('map'), marker);
                });
            }
        }


        function createPlaceList() {
            var placesList = document.getElementById('places');
            placesList.classList.add('mapList');
            for (let itm of markers) {
                var li = document.createElement('li');
                li.textContent = itm.content;
                li.classList.add('place-item');
                li.setAttribute('data-lat', itm.coords.lat);
                li.setAttribute('data-lng', itm.coords.lng);
                placesList.appendChild(li);
            }
        }

        createPlaceList()

        document.getElementById('places').addEventListener('click', function (evt) {
            if (!evt.target.classList.contains('place-item')) { return }

            var lat = evt.target.dataset.lat;
            var lng = evt.target.dataset.lng;
            var latLng = new google.maps.LatLng(parseFloat(lat), parseFloat(lng))

            //add marker

            map.setCenter(latLng)
            map.setZoom(19)
        })
    </script>
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNlchoGwcnpILxNOVmTxZQ8eYWZVzTuDE&libraries=places&callback=initMap"
        async defer></script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="./assets/javascript/javascript.js"></script>
</body>

</html>